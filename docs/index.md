<img width="128" src="multipie_logo.png">

# MultiPie

A Python library for crystallographic symmetry operations and Symmetry-Adapted Multipole Basis (SAMB).
Molecular or crystal structures are best drawn by using [QtDraw](https://github.com/CMT-MU/QtDraw).

## Installation

MultiPie can be installed from PyPI using pip on Python >= 3.8:
```
pip install multipie
```
You can also visit
[PyPI](https://pypi.org/project/multipie/) or [GitHub](https://github.com/CMT-MU/MultiPie) to download the source.

## Authors
Hiroaki Kusunose and Rikuto Oiwa

## Citing MultiPie and QtDraw

If you are using MultiPie and/or QtDraw in your scientific research, please help our scientific visibility by citing our work:

> Hiroaki Kusunose, Rikuto Oiwa, and Satoru Hayami, _Symmetry-adapted modeling for molecules and crystals_, Phys. Rev. B <b>107</b>, 195118 (2023).
>
> DOI: [https://doi.org/10.1103/PhysRevB.107.195118](https://doi.org/10.1103/PhysRevB.107.195118)

BibTex:
```
@article{PhysRevB.107.195118,
title = {Symmetry-adapted modeling for molecules and crystals},
author = {Kusunose, Hiroaki and Oiwa, Rikuto and Hayami, Satoru},
journal = {Phys. Rev. B},
volume = {107},
issue = {19},
pages = {195118},
numpages = {14},
year = {2023},
month = {May},
publisher = {American Physical Society},
doi = {10.1103/PhysRevB.107.195118},
url = {https://link.aps.org/doi/10.1103/PhysRevB.107.195118}
}
```

## Requirements
- This library optionally requires [TeXLive](https://www.tug.org/texlive/) environment to create LaTeX and PDF files.
- Molecular or crystal structure files are optionally generated by [QtDraw](https://github.com/CMT-MU/QtDraw).

## Manual
See, [Manual](https://github.com/CMT-MU/QtDraw/blob/main/docs/manual.pdf).


## Basis Construction

1. Prepare input file. Example input files for [C3v](example/C3v.py) molecule and [graphene](example/graphene.py) are given here.
    ```python
    # C3v.py
    C3v = {
        "model": "C3v",  # name of model.
        "group": "C3v-1",  # name of point group.
        "cell": {"c": 10},  # set large enough interlayer distance.
        #
        "site": {"A": ("[-1/6,-1/6,0]", "s"), "B": ("[-2/3,0,0]", "p")},  # positions of A and B sites and their orbitals.
        "bond": [("A", "A", 1), ("A", "B", 1)],  # nearest-neighbor A-A and B-B bonds.
        #
        "spinful": False,  # spinless.
    }
    ```
    ```python
    # graphene.py
    graphene = {
        "model": "graphene",  #  name of model.
        "group": 191,  # No. of space group.
        "cell": {"c": 4},  # set large enough interlayer distance.
        #
        "site": {"C": ("[1/3,2/3,0]", "pz")},  # positions of C site and its orbital.
        "bond": [("C", "C", [1, 2, 3, 4, 5, 6])],  # C-C bonds up to 6th neighbors.
        #
        "spinful": False,  # spinless.
        #
        "k_point": {"Γ": "[0, 0, 0]", "M": "[1/2, 0, 0]", "K": "[1/3, 1/3, 0]"},  # def. of k points.
        "k_path": "Γ-K-M-Γ",  # high-symmetry line.
    }
    ```
2. At the folder where these two input files exist, do the following to create SAMB.
See for more detail, try "**create_samb --help**" command.
    ```
    $ create_samb C3v graphene
    ```
3. The following files are created in **C3v** and **graphene** folders.
    - C3v_model.py, C3v_samb.py, C3v_matrix.py, C3v_samb.tex, C3v_samb.pdf, C3v_view.qtdw
    - graphene_model.py, graphene_samb.py, graphene_matrix.py, graphene_samb.tex, graphene_samb.pdf, graphene_view.qtdw

    Here, **.tex** and **.pdf** are created if [TeXLive](https://www.tug.org/texlive/) is installed, and **.qtdw** is created if [QtDraw](https://github.com/CMT-MU/QtDraw) is installed.

    Each file contains
    - **_model.py** : model information.
    - **_samb.py** : detailed information on SAMB.
    - **_matrix.py** : full-matrix form of SAMB.
    - **_samb.tex** and **_samb.pdf** : detailed information on SAMB in LaTeX and PDF format.
    - **_view.qtdw** : molecular or crystal structure file for QtDraw.

The detailed file formats are given as follows:
- [input.py](fmt_input.md)
- [_model.py](fmt_model.md)
- [_samb.py](fmt_samb.md)
- [_matrix.py](fmt_matrix.md)

## Example usage of "_matrix.py"

See, the example of plot for **C3v** and **graphene** in [example](https://github.com/CMT-MU/MultiPie/tree/main/docs/example).
Download files in example, and try "**python create_plot.py**" command.


## Change Log
- [version 1.1](ver1.1.md)
